<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/1.png' width='300px'>  

### Berikut langkah-langkah yang saya lakukan untuk mendapatkan flag  


1. <img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/2.png' width='300px'>  
Di web ini saya akan mengupload sebuah webshell yang berfungsi untuk mengontrol server web dan mencari flag nya ada di dalam nya.  

2. Ini adalah webshell yang saya buat menggunakan bahasa pemerograman php.  
<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/3.png' width='300px'>  

3. Saya akan coba dulu bypass filterisasi upload menggunakan metode sederhana dengan menambahkan ekstensi palsu (png).  
<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/4.png' width='300px'>  
Di sini si backend mengetahui bahwa isi file bukanlah PNG asli karna backend melakukan pengecekan pada isi file nya dengan membaca magic bytes.  
Oke ini masih bisa dibypass lagi dengan memanipulasi magic byte nya menggunakan tools hexeditor di kali linux

4. Langsung saja saya edit menggunakan hexeditor. Untuk PNG megic byte nya `50 4E 47`.  
<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/5.png' width='300px'>  

5. Upload file tersebut dan nyalakan intercept di burpsuit untuk mengedit request nya.  
<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/7.png' width='300px'>

` Content-Tyep: aplication/php `


6. <img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/5.png' width='300px'>  
File berhasil terupload.

7. Selanjutnya akses file yang telah diupload tadi ke path **/upload/namafile**, tambahkan dibelakang url nya.  
<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/7.png' width='300px'>  
Setelah masuk ke webshell nya saya langsung menjalankan perintah `pwd`.

8. Saya langsung menjalankan perintah `find / -type f -name *.txt` untuk mencari flag.  
<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/9.png' width='300px'>  
Pada direktori /var/www/html terdapat file yang berisi flag.  
Langsung saja saya cat file nya.  
<img src='https://github.com/LuthfanHilmi/Writeup-CTF/blob/main/web%20exploitation/Trickster/images/10.png' width='300px'>

**Selesai**
